---
title: "Using Simulation to Present Complex Topics"
author: "Ryan Honea"
institution: "Austin Peay State University"
date: "9/30/2017"
output: 
  beamer_presentation:
    template: conftemplate.tex
    slide_level: 3
    theme: "Antibes"
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


# Introduction: Why Simulate?
## Why Simulate?
### Why Simulate?
Common Questions:

- Is it worthwhile to teach programming?
- Wouldn't writing a simulation be hard?
- Why not just use theorems and proofs and other such nonsense?

## Motivation
### Why We Love Math
The Big Questions

- Why do we love math?
- What drives students to love math?
- How can we utilize this information to enhance student's learning?

### Why We Love Math: GRAPHS
```{r, echo = FALSE}
z = function(n,c,p) {
  val = (c - n*p)/(sqrt(n*p*(1-p)))
  return(val)
}
probabilities = c(.600, .650, .700)
n = seq(1,200, by = 1)
power = matrix(NA, nrow = 200, ncol = 1)
z_val = matrix(NA, nrow = 200, ncol = 1)
prob = matrix(NA, nrow = 200, ncol = 1)
c = matrix(NA, nrow = 200, ncol = 1)
dfs <- list()
for (j in 1:3) {
  for (i in 1:200) {
    c[i,] = qnorm(.975, n[i]*.5, sqrt(n[i]*.5*(1-.5)))
    z_val[i,] = z(n[i], c[i,], probabilities[j])
    power[i,] = (1 - pnorm(z_val[i,], 0, 1))
    prob[i,] = probabilities[j]
  }
  dfs[[j]] <- data.frame(n, power, prob)
}
plot(dfs[[1]]$n, dfs[[3]]$power,
     main = "Power versus Number of Samples for Sign Test",
     xlab = "Number of Samples", ylab = "Power",
     col = "darkgreen", type = "l", lty=3)
lines(dfs[[1]]$n, dfs[[2]]$power, col = "dodgerblue", lty = 2)
lines(dfs[[1]]$n, dfs[[1]]$power, col = "firebrick4", lty = 1)
legend(1, legend=c("p = .60", "p = .65", "p = .70"),
       col=c("firebrick4","dodgerblue","darkgreen"), lty=1:3, cex=0.8)
```
### Why We Love Math: FUNctions and Equations!
$$\frac{\partial (\rho e)}{\partial t} + (\rho e+p)\frac{\partial u_{i}}{\partial x_{i}} = \frac{\partial(\tau_{ij}u_{j})}{\partial x_{i}} + \rho f_{i}u_{i} + \frac{\partial(\dot{ q_{i}})}{\partial x_{i}} + r \quad \text{(Navier-Stokes)}$$
$$\frac{\partial V}{\partial t}
+ \frac{\sigma^2 S^2}{2} \frac{\partial^2 V}{\partial S^2}
+ r S \frac{\partial V}{\partial S} - rV = 0 \label{eq:BS} \quad \text{(Black-Scholes)}$$

$$f(x)=\sum_{n=0} ^\infty a^n \cos(b^n \pi x) \quad \text{(Weirstrauss Function)}$$
### Why We Love Math: It Just Works?
When asking groups of fellow students over the last week why they love math, most answers came down to the same ideas

- It solves cool real world problems
- It feels like a puzzle sometimes
- When it just works (like $e$)

### Senior Research Project
Assignment: Find the probability that a percolating cluster appears in Mat\'ern II Point Process distributed Poisson($\lambda$)

- What does it mean?
- How do I solve this?
- What's a Mat\'ern?
- What's a percolating cluster?

### Senior Research Project
```{r, echo = FALSE}
a <- .025
pois <- rpois(1, 7500) #Generates a point of poisson variance for following lines.
xval <- runif(pois, min=0, max=1)
yval <- runif(pois, min=0,max=1)
par(mfrow=c(1, 2))
plot(xval, yval,main="Poisson Process",xlab="x", ylab="y")
adj <- diag(pois+1) #initializing this matrix
for(i in 1:(pois-1)){
  for(j in (i+1):pois){
    if((sqrt((xval[j]-xval[i])^2+(yval[j]-yval[i])^2)) < a){
      xval[i] = 0
      yval[i] = 0
    }
  }
}
xval <- xval[xval != 0] #Removing all deleted points
yval <- yval[yval != 0] #Removing all deleted points
xval <- c(0,xval) #Creating a center (origin) point
yval <- c(0,yval) #Creating a center (origin) point
plot(xval,yval,main="Matern II",xlab="x", ylab="y")
```

### Senior Research Project
```{r, echo = FALSE}
p <-  .5 #Multiplied by 1.1 so that probability is never 1
r <- .1
a <- (1/5)*r
pois <- rpois(1, 3500) #Generates a point of poisson variance for following lines.
xval <- runif(pois, min=-1, max=1)
yval <- runif(pois, min=-1,max=1)
adj <- diag(pois+1) #initializing this matrix
  for(i in 1:(pois-1)){
    for(j in (i+1):pois){
      if((sqrt((xval[j]-xval[i])^2+(yval[j]-yval[i])^2)) < a){
          xval[i] = 0
          yval[i] = 0
      }
     }
  }
xval <- xval[xval != 0] #Removing all deleted points
yval <- yval[yval != 0] #Removing all deleted points
xval <- c(0,xval) #Creating a center (origin) point
yval <- c(0,yval) #Creating a center (origin) point
plot(xval,yval,main="Matern II, a = (4/5)r")
for(i in 1:length(xval)) {
  for(j in 1:length(xval)){
    if((sqrt((xval[i]-xval[j])^2+(yval[i]-yval[j])^2)) < r && runif(1,0,1) < p){
      adj[i,j] = 1
      segments(xval[j],yval[j],xval[i],yval[i])
    }
  }
}
```

### Senior Research Project
```{r, echo = FALSE}
p <-  .5 #Multiplied by 1.1 so that probability is never 1
r <- .1
a <- (3/5)*r
pois <- rpois(1, 3500) #Generates a point of poisson variance for following lines.
xval <- runif(pois, min=-1, max=1)
yval <- runif(pois, min=-1,max=1)
adj <- diag(pois+1) #initializing this matrix
  for(i in 1:(pois-1)){
    for(j in (i+1):pois){
      if((sqrt((xval[j]-xval[i])^2+(yval[j]-yval[i])^2)) < a){
          xval[i] = 0
          yval[i] = 0
      }
     }
  }
xval <- xval[xval != 0] #Removing all deleted points
yval <- yval[yval != 0] #Removing all deleted points
xval <- c(0,xval) #Creating a center (origin) point
yval <- c(0,yval) #Creating a center (origin) point
plot(xval,yval,main="Matern II, a = (4/5)r")
for(i in 1:length(xval)) {
  for(j in 1:length(xval)){
    if((sqrt((xval[i]-xval[j])^2+(yval[i]-yval[j])^2)) < r && runif(1,0,1) < p){
      adj[i,j] = 1
      segments(xval[j],yval[j],xval[i],yval[i])
    }
  }
}
```

## Context of this Presentation
### The "Traditional" Statistics Course

- Measures of Center
- Sampling
- Regression
- Hypothesis Testing

### More Intense Problems

- Non-Normal Distributions
    - Poisson
    - Binomial
    - Exponential
- Central Limit Theorem

# The "Traditional" Statistics Course
## Measures of Center
### Measures of Center
- Measures of center usually taught in respect to a symmetric distibution, left skewed distribution, and a right skewed distribution.
- How can we improve this information through simulation?
- More specifically, how can we show this without having data on hand?

### Measures of Center on a Symmetric Distribution
The Simulation

```{r, echo = TRUE, eval = FALSE}
sim <- rbeta(10000,5,5)
hist(sim, main = "Symmetric Distribution")
abline(v = mean(sim), col = "red", lwd = 3)
abline(v = median(sim), col = "blue", lwd = 3, lty = 2)
legend(0.05, 1200, c("Mean","Median"), col = c("red", "blue"), lty = c(1,2))
````

### Measures of Center on a Symmetric Distribution
```{r, echo = FALSE}
sim <- rbeta(10000,5,5)
hist(sim, main = "Symmetric Distribution")
abline(v = mean(sim), col = "red", lwd = 3)
abline(v = median(sim), col = "blue", lwd = 3, lty = 2)
legend(0.05, 1200, c("Mean","Median"), col = c("red", "blue"), lty = c(1,2))
```

### Measures of Center on a Left-Skewed Distribution
```{r, echo = TRUE, eval = FALSE}
sim <- rbeta(10000,5,2)
hist(sim, main = "Left-Skewed Distribution")
abline(v = mean(sim), col = "red", lwd = 3)
abline(v = median(sim), col = "blue", lwd = 3, lty = 2)
legend(0.05, 1200, c("Mean","Median"), col = c("red", "blue"), lty = c(1,2))
```

### Measures of Center on a Left-Skewed Distribution
```{r, echo = FALSE}
sim <- rbeta(10000,5,2)
hist(sim, main = "Left-Skewed Distribution")
abline(v = mean(sim), col = "red", lwd = 3)
abline(v = median(sim), col = "blue", lwd = 3, lty = 2)
legend(0.05, 1200, c("Mean","Median"), col = c("red", "blue"), lty = c(1,2))
```

### Measures of Center on a Right-Skewed Distribution
```{r, echo = TRUE, eval = FALSE}
sim <- rbeta(10000,2,5)
hist(sim, main = "Right-Skewed Distribution")
abline(v = mean(sim), col = "red", lwd = 3)
abline(v = median(sim), col = "blue", lwd = 3, lty = 2)
legend(0.05, 1200, c("Mean","Median"), col = c("red", "blue"), lty = c(1,2))
```

### Measures of Center on a Right-Skewed Distribution
```{r, echo = FALSE}
sim <- rbeta(10000,2,5)
hist(sim, main = "Right-Skewed Distribution")
abline(v = mean(sim), col = "red", lwd = 3)
abline(v = median(sim), col = "blue", lwd = 3, lty = 2)
legend(0.6, 1200, c("Mean","Median"), col = c("red", "blue"), lty = c(1,2))
```

## Sampling
### Sampling in R
The true bueaty of simulation lies in sampling (which is the core of most statistics).

- R can simulate from any notable distribution (and some non-notable!)
- R can then randomly sample from any of these distributions
- We can show elements of sampling empiracally to students through these two easily understandable parts of R

### Sampling Examples
```{r, echo = TRUE}
sim <- rnorm(10000)
cat("Mean of Simulation is:", mean(sim), "\n")
sim_sample <- sample(sim, 1000)
cat("Mean of Sim Sample is:", mean(sim_sample), "\n")
cat("Difference between Sample and Pop Mean:",
  abs(mean(sim) - mean(sim_sample)),"\n")
```


## Regression
## Hypothesis Testing

# Elevating the Statistics Course
## Non-Normal Distributions
## Central Limit Theorem

# Conclusion
## Conclusion
### Conclusion

## Acknowledgement
### Acknowledgements